-# in app/views/projects/index.html.haml

- if current_user
  %div.col-md-12
    %h2 My Projects
  %div{"ng-controller" => "ProjectsController as projects"}
    %span.col-md-6
      %div#accordian.panel-group{:role => "tablist", "aria-multiselectable" => "true"}    
        - current_user.projects.each do |p|
          %div.panel.panel-default
            %div.panel-heading{:role => "tab", :id => "heading#{p.id}"}
              %h4.panel-title
                %a{"data-toggle" => "collapse", "data-parent" => "#accordian", :href => "#collapse#{p.id}", 
                   "aria-expanded" => "true", "aria-controls" => "collapse#{p.id}", "ng-click" => "projects.showSprints(#{p.id})"}
                  =p.project_name
                  %span.badge.pull-right
                    =p.count_discussions
            %div.panel-collapse.collapse{:id => "collapse#{p.id}", :role => "tabpanel", "aria-labelledby" => "heading#{p.id}"}
              %div.panel-body
                %p
                  Description: #{p.project_description} 
                %p
                  Github Repo: #{p.project_github}
        %div.panel.panel-default
          %div#newProject.panel-heading{:role => "tab"}
            %h4.panel-title
              %a{"data-toggle" => "collapse", "data-parent" => "#accordian", :href => "#collapseNewProject", 
                "aria-expanded" => "true", "aria-controls" => "collapseNewProject", "ng-click" => "projects.hideAll()"}
                New Project
                %span.glyphicon.glyphicon-plus.pull-right
          %div#collapseNewProject.panel-collapse.collapse{:role => "tabpanel", "aria-labelledby" => "newProject"}
            %div.panel-body
              %form{:role => "form", :method => "post"}
                %div.form-group
                  %label{:for => "project_name"} Name
                  %input.form-control{:placeholder => "Project name", :type => "name", :id => "project_name", :name => "project[project_name]"}    
                %div.form-group
                  %label Description
                  %textarea.form-control{:placeholder => "Project description", :rows => "3", :name => "project[project_description]"}  
                %div.form-group
                  %label Github Repository
                  %input.form-control{:placeholder => "Project repository", :type => "text", :name => "project[project_github]"} 	
                %button.btn.btn-primary{:type => "submit"}
                  Create
  
    %span.col-md-6.pull-right{"ng-show" => "sprintsVisible"}
      %div.well
        %ul.list-group
          %li.list-group-item.active
            Sprints
          %li.list-group-item{"ng-repeat" => "sprint in sprints"}
            %button.btn.btn-link 
              {{sprint.sprint_start_date}} - {{sprint.sprint_end_date}}
            %span.badge.pull-right
              {{sprint.discussions}}
          %li.list-group-item
            %div#form.panel-group{:role => "tablist", "aria-multiselectable" => "true"}
              %div.panel.panel-default
                %div#formHeading.panel-heading{:role => "tab"}
                  %h4.panel-title
                    %a{"data-toggle" => "collapse", "data-parent" => "#form", :href => "#collapseForm", 
                       "aria-expanded" => "true", "aria-controls" => "#collapseForm"}
                      New Sprint
                      %span.glyphicon.glyphicon-plus.pull-right
                %div#collapseForm.panel-collapse.collapse{:role => "tabpanel", "aria-labelledby" => "#formHeading"}
                  %div.panel-body
                    %form{:role => "form"}
                      %div.form-group
                        %label{:for => "startDate"}
                          Sprint Start Date
                        %input#startDate.form-control{:type => "date", "ng-model" => "start_date"}
                      %div.form-group
                        %label{:for => "endDate"}
                          Sprint End Date
                        %input#endDate.form-control{:type => "date", "ng-model" => "end_date"}
                      %button.btn.btn-primary{:type => "submit", "ng-click" => "projects.validate()"}
                        Create
        
=javascript_include_tag 'projects'


